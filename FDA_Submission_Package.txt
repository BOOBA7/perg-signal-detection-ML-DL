# üßæ FDA SUBMISSION PACKAGE ‚Äì SIMULATED  
## Software as a Medical Device (SaMD)  
### Title: PERG Signal Classifier via ML & DL  
**Author**: Anis Boubala  
**Date**: July 2025  

---

## 1. DEVICE OVERVIEW

**Device Name**: PERG Signal Classifier  
**Type**: Software as a Medical Device (SaMD)  

**Indication for Use**:  
> To assist ophthalmologists in identifying alterations in pattern electroretinogram (PERG) signals, potentially indicative of early-stage retinal or optic nerve dysfunction (e.g., glaucoma, dystrophies).

**Device Description**:  
A software-based decision-support tool for binary classification of electrophysiological PERG signals (RE_1, LE_1), developed using:
- Classical machine learning models trained on frequency-domain features and clinical metadata.
- Deep learning architectures trained on concatenated FFT features and patient data.

**Output**:  
- Binary classification: `"Normal PERG"` or `"Altered PERG"`  
- Probability score with optional threshold tuning

---

## 2. INTENDED USE

- **Target Population**: Adults aged 18‚Äì90 undergoing PERG functional testing.  
- **Intended Environment**: Ophthalmology clinics, vision research centers.  
- **End Users**: Ophthalmologists and qualified technicians.  
- **Clinical Role**: Decision support (CDS); not intended for autonomous diagnosis.  
- **Device Status**: Research-use only; not FDA-cleared.  

---

## 3. DATA & LABELING

**Dataset**: PERG-IOBA Dataset (PhysioNet repository)  
**Participants**:  
- 304 unique individuals recruited between 2003‚Äì2022 at IOBA (Spain)  
- Age: 4‚Äì86 years (mean: 37.1 ¬± 18.3)  
- Sex: 155 female participants  
- 23 individuals had repeated visits (total >304 records)  
- 100 participants were clinically ‚ÄúNormal‚Äù  

**Final Dataset for Modeling**:  
- **242 usable PERG records** with valid RE_1 and LE_1 signals and complete clinical metadata  
- **Signal Channels**: RE_1 and LE_1 (sampled at 300 Hz, microvolt resolution)  
- **Metadata**: Age, sex, and diagnosis  
- **Ground Truth**: Labels derived from expert-confirmed clinical tags in `metadata_clinical.csv`  
- **Binary Labels**:  
  - 1: Pathological (e.g., retinitis pigmentosa, Stargardt disease, optic neuropathy)  
  - 0: Normal (no ocular pathology)

---

## 4. MODELS EVALUATED

**Classical ML Models**:
- Logistic Regression
- Decision Tree
- Random Forest (**top-performing classical model**)
- XGBoost  

**Deep Learning Architecture**:
- Fully connected feedforward neural network (Keras / TensorFlow)  
- Input: Concatenated FFT-derived features (RE_1 + LE_1) + clinical metadata (age, sex)  
- Design: Dense ‚Üí BatchNorm ‚Üí Dropout (3‚Äì4 layers total)  
- Optimizer: Adam  
- Loss: Binary Crossentropy  
- Threshold tuning: ROC-based and F1-score maximization  

---

## 5. PERFORMANCE SUMMARY

| Model Type         | AUC    | Recall | Specificity | F1-Score | Accuracy | Threshold     |
|--------------------|--------|--------|-------------|----------|----------|---------------|
| Random Forest (ML) | **0.768** | 0.70   | 0.70        | 0.69     | **0.71**   | 0.50 (default) |
| Deep Learning       | 0.660  | **0.93** | 0.33        | **0.76** | 0.67     | 0.40 (F1-opt)  |

**Interpretation**:  
- The **Random Forest** model exhibits balanced sensitivity/specificity and the highest AUC.  
- The **Deep Learning** model achieves higher recall (sensitivity), making it preferable in screening settings where false negatives must be minimized, albeit with lower specificity.

---

## 6. GOOD MACHINE LEARNING PRACTICES (GMLP)

- ‚úÖ Stratified and balanced training/test splits  
- ‚úÖ Clear feature engineering (FFT statistics, patient demographics)  
- ‚úÖ Transparent model architecture with reproducible training settings  
- ‚úÖ ROC-based threshold optimization strategies  
- ‚úÖ Versioning via GitHub and code documentation  
- ‚úÖ Ground truth derived from expert-labeled clinical data  

---

## 7. VALIDATION STRATEGY

- **Data Partitioning**:  
  - Stratified hold-out split (80/20) for training/validation  
  - 50/50 class balance for fair metric interpretation  
- **Threshold Evaluation**:  
  - Multi-threshold grid search from 0.1 to 0.9  
  - Selection based on F1-score or sensitivity constraint (TPR ‚â• 0.90)  
- **Metrics Computed**:  
  - ROC-AUC  
  - Sensitivity, Specificity  
  - Accuracy, F1-score  
  - Confusion matrix + classification report  

---

## 8. RISK ANALYSIS (ISO 14971-Inspired)

| Risk Type                          | Mitigation Strategy                                      |
|-----------------------------------|-----------------------------------------------------------|
| ‚ùå False Negatives (missed cases) | Threshold adjustment to ensure high recall (TPR ‚â• 0.90)   |
| ‚ö†Ô∏è False Positives (unwarranted concern) | Manual review required; specificity tracked           |
| ‚ö†Ô∏è Dataset Bias                   | Stratified sampling; balanced evaluation                 |
| ‚ùå Overfitting (small dataset)     | Dropout, early stopping, regularization, cross-validation |

---

## 9. LIMITATIONS

- No external prospective validation (single-center retrospective dataset)  
- Raw signal quality not uniformly pre-processed for noise/artifacts  
- No integration with Electronic Health Records (EHRs)  
- Model trained offline; real-time integration not yet implemented  
- Ground truth limited to clinical labels; no genetic confirmation  

---

## 10. FUTURE WORK

- Engage FDA Q-Submission program for premarket feedback  
- Conduct external validation on multi-institutional cohort  
- Develop GUI or web-based CDS interface for clinicians  
- Implement real-time signal acquisition API for hardware integration  
- Explore advanced architectures (CNNs, attention mechanisms, LSTMs)

---

## 11. DISCLAIMER

This document simulates a pre-submission to the U.S. Food & Drug Administration (FDA) for **educational and research purposes only**.  
The PERG Signal Classifier is **not an approved or cleared medical device** and must **not** be used for clinical decision-making.  
All performance claims are based on retrospective evaluation using publicly available data from PhysioNet (PERG-IOBA).

