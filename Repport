# perg-signal-detection-ml

# ğŸ§  DÃ©tection automatisÃ©e du signal PERG par Machine Learning & Deep Learning

## ğŸ¯ Objectif

Ce projet simule un cas rÃ©el en **bioinformatique mÃ©dicale** en dÃ©veloppant un pipeline complet pour la **dÃ©tection dâ€™altÃ©rations du signal PERG** (Pattern Electroretinogram), utilisÃ© en ophtalmologie pour dÃ©pister des pathologies rÃ©tiniennes ou optiques.

Lâ€™objectif est de comparer diffÃ©rentes approches (ML vs DL) pour dÃ©terminer leur efficacitÃ© en **dÃ©pistage assistÃ© par lâ€™IA**, tout en respectant les contraintes du domaine clinique (sensibilitÃ© Ã©levÃ©e, traÃ§abilitÃ©, explicabilitÃ©).

---

## ğŸ§ª DonnÃ©es utilisÃ©es

- **Source** : [PERG-IOBA Dataset â€“ PhysioNet](https://physionet.org/content/perg-ioba-dataset/1.0.0/)
- **Contenu** :
  - Signaux bruts des deux yeux (`RE_1`, `LE_1`)
  - MÃ©tadonnÃ©es cliniques : Ã¢ge, sexe, diagnostic
- **Label binaire** (ground truth) :
  - `0` : signal normal
  - `1` : signal altÃ©rÃ© (pathologie affectant le nerf optique ou la rÃ©tine)

---

## ğŸ§¬ Extraction de features (ML)

Pour les modÃ¨les de Machine Learning, les features sont extraits manuellement :

- **Statistiques temporelles** : moyenne, Ã©cart-type, min, max, amplitude
- **Moments** : asymÃ©trie (skewness), aplatissement (kurtosis)
- **ParamÃ¨tres cliniques** : amplitude et latence de P50 et N95
- **Analyse frÃ©quentielle (FFT)** : frÃ©quence dominante, Ã©nergie spectrale
- **DÃ©mographie** : Ã¢ge, sexe (encodÃ©)

---

## âš™ï¸ ModÃ©lisation

### ğŸ”¹ Machine Learning :
- Algorithmes : Logistic Regression, Decision Tree, XGBoost, Random Forest
- Features manuelles (FFT + stats cliniques + dÃ©mographie)
- Validation croisÃ©e (stratifiÃ©e, 5 folds)
- Test sur :
  - Jeu Ã©quilibrÃ© (50/50)
  - Jeu Ã  prÃ©valence rÃ©aliste (~2%)

### ğŸ”¸ Deep Learning :
- RÃ©seaux de neurones profonds (Keras / TensorFlow)
- EntrÃ©e : concatÃ©nation RE_1 + LE_1 + mÃ©tadonnÃ©es
- Architecture dense (avec Dropout + BatchNorm)
- Optimisation de seuil basÃ©e sur :
  - ğŸ“ˆ **Indice de Youden**
  - ğŸ¯ **F1-score maximal**

---

## ğŸ“ˆ RÃ©sultats comparÃ©s

### âœ… Ã‰valuation finale sur jeu Ã©quilibrÃ© (test 50/50)

| ModÃ¨le              | AUC     | SensibilitÃ© | SpÃ©cificitÃ© | F1-score | Accuracy |
|---------------------|---------|-------------|-------------|----------|----------|
| Random Forest (ML)  | **0.768** | 0.818       | 0.591       | 0.735    | **0.705** |
| Deep Learning (DL)  | 0.660   | **0.928**   | 0.333       | **0.765**| 0.673    |

ğŸ” **Analyse seuil F1-optimal pour DL** :  
- Seuil : 0.45  
- Recall : 92.9 %  
- SpÃ©cificitÃ© : 33.3 %  
- Accuracy : 67.3 %  
- F1-score : 0.765

---

## ğŸ©º InterprÃ©tation clinique (bioinformatique)

- ğŸ“Œ En ophtalmologie, **une haute sensibilitÃ© est prioritaire** pour ne pas rater de patients pathologiques (faux nÃ©gatifs).
- Le modÃ¨le **deep learning** est donc adaptÃ© comme outil de **prÃ©-tri automatisÃ©**.
- Le modÃ¨le **Random Forest** est mieux Ã©quilibrÃ© (AUC supÃ©rieur), plus robuste dans un contexte de screening gÃ©nÃ©ral.
- Ces rÃ©sultats simulent un cas dâ€™aide au diagnostic, **non destinÃ© Ã  remplacer lâ€™opinion clinique**.

---

## ğŸ“Š Analyse seuils multiples

Une analyse fine des performances selon diffÃ©rents seuils montre que :

- Seuil 0.45 maximise la **F1-score globale** (DL)  
- Seuils plus bas (<0.3) maximisent la sensibilitÃ© mais induisent trop de faux positifs  
- Le compromis Recall / SpÃ©cificitÃ© dÃ©pend du **cas dâ€™usage clinique** :
  - ğŸ”¬ Triage en amont : sensibilitÃ© haute
  - ğŸ“‰ Diagnostic assistÃ© : AUC Ã©levÃ© + spÃ©cificitÃ© modÃ©rÃ©e

---

## ğŸ’¡ Bonnes pratiques bioinformatiques

- âœ”ï¸ **ExplicabilitÃ©** pour les modÃ¨les ML (features cliniques interprÃ©tables)
- âœ”ï¸ **ReproductibilitÃ©** via notebooks versionnÃ©s (GitHub)  
- âœ”ï¸ **Validation croisÃ©e + test simulÃ© rÃ©aliste**  
- âœ”ï¸ **Analyse par seuils** avec rapport complet (ROC, confusion, F1, TPR, TNR)
- â— **Pas dâ€™intÃ©gration temps rÃ©el ni validation externe pour lâ€™instant**

---

## âœ… Conclusion

Ce projet dÃ©montre la faisabilitÃ© dâ€™un **pipeline bioinformatique rigoureux** appliquÃ© Ã  lâ€™ophtalmologie.

- Il met en Å“uvre Ã  la fois **approche classique (ML)** et **deep learning**, en les Ã©valuant dans un **cadre mÃ©dical simulÃ©**, fidÃ¨le aux contraintes cliniques.
- Le modÃ¨le deep learning montre des performances utiles en **dÃ©pistage sensible**, tandis que le modÃ¨le Random Forest reste une **valeur sÃ»re explicable**.
- Ce travail sert de **preuve de concept** pour une future validation clinique.

---

## ğŸ“ RÃ©fÃ©rences

- [PERG-IOBA Dataset â€“ PhysioNet](https://physionet.org/content/perg-ioba-dataset/1.0.0/)
- FDA GMLP Principles (2021)
- ISO 14971 â€“ Risk management in medical devices
