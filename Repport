# perg-signal-detection-ml

# 🧠 Détection automatisée du signal PERG par Machine Learning & Deep Learning

## 🎯 Objectif

Ce projet simule un cas réel en **bioinformatique médicale** en développant un pipeline complet pour la **détection d’altérations du signal PERG** (Pattern Electroretinogram), utilisé en ophtalmologie pour dépister des pathologies rétiniennes ou optiques.

L’objectif est de comparer différentes approches (ML vs DL) pour déterminer leur efficacité en **dépistage assisté par l’IA**, tout en respectant les contraintes du domaine clinique (sensibilité élevée, traçabilité, explicabilité).

---

## 🧪 Données utilisées

- **Source** : [PERG-IOBA Dataset – PhysioNet](https://physionet.org/content/perg-ioba-dataset/1.0.0/)
- **Contenu** :
  - Signaux bruts des deux yeux (`RE_1`, `LE_1`)
  - Métadonnées cliniques : âge, sexe, diagnostic
- **Label binaire** (ground truth) :
  - `0` : signal normal
  - `1` : signal altéré (pathologie affectant le nerf optique ou la rétine)

---

## 🧬 Extraction de features (ML)

Pour les modèles de Machine Learning, les features sont extraits manuellement :

- **Statistiques temporelles** : moyenne, écart-type, min, max, amplitude
- **Moments** : asymétrie (skewness), aplatissement (kurtosis)
- **Paramètres cliniques** : amplitude et latence de P50 et N95
- **Analyse fréquentielle (FFT)** : fréquence dominante, énergie spectrale
- **Démographie** : âge, sexe (encodé)

---

## ⚙️ Modélisation

### 🔹 Machine Learning :
- Algorithmes : Logistic Regression, Decision Tree, XGBoost, Random Forest
- Features manuelles (FFT + stats cliniques + démographie)
- Validation croisée (stratifiée, 5 folds)
- Test sur :
  - Jeu équilibré (50/50)
  - Jeu à prévalence réaliste (~2%)

### 🔸 Deep Learning :
- Réseaux de neurones profonds (Keras / TensorFlow)
- Entrée : concaténation RE_1 + LE_1 + métadonnées
- Architecture dense (avec Dropout + BatchNorm)
- Optimisation de seuil basée sur :
  - 📈 **Indice de Youden**
  - 🎯 **F1-score maximal**

---

## 📈 Résultats comparés

### ✅ Évaluation finale sur jeu équilibré (test 50/50)

| Modèle              | AUC     | Sensibilité | Spécificité | F1-score | Accuracy |
|---------------------|---------|-------------|-------------|----------|----------|
| Random Forest (ML)  | **0.768** | 0.818       | 0.591       | 0.735    | **0.705** |
| Deep Learning (DL)  | 0.660   | **0.928**   | 0.333       | **0.765**| 0.673    |

🔍 **Analyse seuil F1-optimal pour DL** :  
- Seuil : 0.45  
- Recall : 92.9 %  
- Spécificité : 33.3 %  
- Accuracy : 67.3 %  
- F1-score : 0.765

---

## 🩺 Interprétation clinique (bioinformatique)

- 📌 En ophtalmologie, **une haute sensibilité est prioritaire** pour ne pas rater de patients pathologiques (faux négatifs).
- Le modèle **deep learning** est donc adapté comme outil de **pré-tri automatisé**.
- Le modèle **Random Forest** est mieux équilibré (AUC supérieur), plus robuste dans un contexte de screening général.
- Ces résultats simulent un cas d’aide au diagnostic, **non destiné à remplacer l’opinion clinique**.

---

## 📊 Analyse seuils multiples

Une analyse fine des performances selon différents seuils montre que :

- Seuil 0.45 maximise la **F1-score globale** (DL)  
- Seuils plus bas (<0.3) maximisent la sensibilité mais induisent trop de faux positifs  
- Le compromis Recall / Spécificité dépend du **cas d’usage clinique** :
  - 🔬 Triage en amont : sensibilité haute
  - 📉 Diagnostic assisté : AUC élevé + spécificité modérée

---

## 💡 Bonnes pratiques bioinformatiques

- ✔️ **Explicabilité** pour les modèles ML (features cliniques interprétables)
- ✔️ **Reproductibilité** via notebooks versionnés (GitHub)  
- ✔️ **Validation croisée + test simulé réaliste**  
- ✔️ **Analyse par seuils** avec rapport complet (ROC, confusion, F1, TPR, TNR)
- ❗ **Pas d’intégration temps réel ni validation externe pour l’instant**

---

## ✅ Conclusion

Ce projet démontre la faisabilité d’un **pipeline bioinformatique rigoureux** appliqué à l’ophtalmologie.

- Il met en œuvre à la fois **approche classique (ML)** et **deep learning**, en les évaluant dans un **cadre médical simulé**, fidèle aux contraintes cliniques.
- Le modèle deep learning montre des performances utiles en **dépistage sensible**, tandis que le modèle Random Forest reste une **valeur sûre explicable**.
- Ce travail sert de **preuve de concept** pour une future validation clinique.

---

## 📁 Références

- [PERG-IOBA Dataset – PhysioNet](https://physionet.org/content/perg-ioba-dataset/1.0.0/)
- FDA GMLP Principles (2021)
- ISO 14971 – Risk management in medical devices
