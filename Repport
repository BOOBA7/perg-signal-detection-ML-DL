# ğŸ§  PERG Signal Classifier â€“ ML & Deep Learning

## ğŸ”¬ DÃ©tection automatisÃ©e du signal PERG (Pattern Electroretinogram)

Ce projet simule un cas dâ€™usage en **bioinformatique clinique** : lâ€™analyse automatique de signaux PERG pour la dÃ©tection dâ€™anomalies associÃ©es Ã  des atteintes prÃ©coces du nerf optique ou de la rÃ©tine (glaucome, neuropathies, etc.).

Lâ€™objectif est de comparer des modÃ¨les **Machine Learning (ML)** et **Deep Learning (DL)** pour un usage de **triage assistÃ© par IA**.  
Il repose sur des signaux Ã©lectrophysiologiques rÃ©els (dataset open source), en suivant les bonnes pratiques de traÃ§abilitÃ©, reproductibilitÃ©, validation croisÃ©e et sÃ©lection de seuil.

---

## ğŸ§ª DonnÃ©es utilisÃ©es

- **Source** : [PERG-IOBA â€“ PhysioNet (2024)](https://physionet.org/content/perg-ioba-dataset/1.0.0/)
- **Format** : 279 signaux bruts (RE_1, LE_1), 300 Hz, + mÃ©tadonnÃ©es cliniques (Ã¢ge, sexe, diagnostic)
- **Ground truth** : Diagnostic binaire confirmÃ© par ophtalmologiste (label = 0/1)
- **Distribution** : prÃ©valence pathologique â‰ˆ 2 % (rÃ©aliste, dÃ©sÃ©quilibrÃ©e)

---

## ğŸ” Feature Engineering (ML)

Les modÃ¨les classiques utilisent des **features extraites manuellement** :

- Statistiques de base : moyenne, min, max, std
- Moments dâ€™ordre supÃ©rieur : skewness, kurtosis
- Analyse frÃ©quentielle : FFT (magnitude moyenne, max, Ã©nergie spectrale)
- MÃ©tadonnÃ©es : Ã¢ge, sexe encodÃ©

---

## âš™ï¸ ModÃ©lisation

### ğŸ§  Machine Learning :
- ModÃ¨les testÃ©s : `Logistic Regression`, `Decision Tree`, `Random Forest`, `XGBoost`
- EntrÃ©e : FFT + statistiques temporelles + mÃ©tadonnÃ©es
- Validation croisÃ©e stratifiÃ©e (5-fold)
- Jeu de test :
  - âœ… **Ã‰quilibrÃ© (50/50)** : Ã©valuation robuste
  - âœ… **PrÃ©valence rÃ©elle (~2%)** : simulation rÃ©aliste

### ğŸ¤– Deep Learning :
- Framework : TensorFlow / Keras
- Architecture : fully connected (Dense â†’ Dropout â†’ BatchNorm)
- EntrÃ©e :
  - **ConcatÃ©nation** des signaux RE_1 + LE_1 (via FFT)
  - **MÃ©tadonnÃ©es** cliniques
- Optimisation :
  - `binary_crossentropy` + `AUC` en mÃ©trique
  - SÃ©lection du **seuil optimal** selon :
    - ğŸ¯ SensibilitÃ© â‰¥ 0.8
    - ğŸ“Š F1-score maximal
    - ğŸ“ˆ Indice de Youden

---

## ğŸ“ˆ RÃ©sultats (test Ã©quilibrÃ©)

| ModÃ¨le              | AUC     | SensibilitÃ© | SpÃ©cificitÃ© | F1-score | Accuracy | Seuil |
|---------------------|---------|-------------|-------------|----------|----------|--------|
| ğŸ”¹ Random Forest     | **0.768** | 0.818       | 0.591       | 0.735    | **0.705** | 0.46   |
| ğŸ”¸ Deep Learning     | 0.660   | **0.928**   | 0.333       | **0.765**| 0.673    | 0.45   |

### ğŸ“Š Rapport DL (seuil = 0.45)

- **Recall** : 92.9 %
- **SpÃ©cificitÃ©** : 33.3 %
- **Accuracy** : 67.3 %
- **F1-score** : 0.765  
- **Precision classe positive** : 65 %

---

## ğŸ©º InterprÃ©tation clinique

| CritÃ¨re                | DL Model (RE/LE + meta)       | ML Model (Random Forest)     |
|------------------------|-------------------------------|-------------------------------|
| ğŸ”¬ SensibilitÃ©         | âœ… Excellente (triage efficace) | Moyenne Ã  bonne               |
| ğŸ“‰ SpÃ©cificitÃ©         | Limite (faux positifs)         | Meilleure                     |
| ğŸ§  InterprÃ©tabilitÃ©     | Faible (DL boÃ®te noire)        | Bonne (features cliniques)    |
| ğŸ¥ Cas dâ€™usage idÃ©al   | PrÃ©trisage automatique         | DÃ©pistage gÃ©nÃ©ral explicable  |

â¡ï¸ Le modÃ¨le DL est intÃ©ressant pour **maximiser la dÃ©tection**, mais nÃ©cessite une **relecture humaine**.  
â¡ï¸ Le modÃ¨le RF est **plus stable** et **Ã©quilibrÃ©** pour un usage plus conservateur.

---

## ğŸ“Š Analyse des seuils (DL)

```text
Threshold  SensibilitÃ©  SpÃ©cificitÃ©  F1-score   Accuracy
--------------------------------------------------------
0.10       1.0000       0.0000       0.7273     0.5714
0.20       1.0000       0.0476       0.7368     0.5918
0.30       0.9643       0.0476       0.7200     0.5714
0.40       0.9643       0.1905       0.7500     0.6327
0.45       0.9286       0.3333       0.7647     0.6735 âœ… (seuil retenu)
0.60       0.1071       0.9524       0.1875     0.4694
0.75+      0.0000       1.0000       0.0000     0.4286

âœ… Bonnes pratiques bioinformatiques

| Pratique                                  | ImplÃ©mentÃ©e |
| ----------------------------------------- | ----------- |
| ğŸ§ª Validation croisÃ©e + test rÃ©aliste     | âœ…           |
| ğŸ“Š Rapport complet (ROC, confusion, F1)   | âœ…           |
| ğŸ“¦ Fichiers reproductibles (.npy, .csv)   | âœ…           |
| âš–ï¸ Class weights pour dÃ©sÃ©quilibre        | âœ…           |
| ğŸ” Analyse de seuils personnalisÃ©e        | âœ…           |
| ğŸ“ Versioning (git) & logs dâ€™entraÃ®nement | âœ…           |
| ğŸ“ˆ Visualisation TensorBoard              | âœ…           |


âš ï¸ Limites & perspectives


âŒ Pas de validation clinique externe

âŒ Pas dâ€™intÃ©gration temps rÃ©el (EHR, API PERG)

âŒ Dataset limitÃ© en taille et diversitÃ©

â— SpÃ©cificitÃ© faible pour le DL (risque dâ€™over-referral)

ğŸ§­ Futures pistes :

Validation multicentrique prospective

IntÃ©gration interface web ou GUI clinique

EntraÃ®nement avec modÃ¨les sÃ©quentiels (e.g. CNN, LSTM)

Analyse des artefacts / qualitÃ© signal

ğŸ“ RÃ©fÃ©rences


PERG-IOBA â€“ PhysioNet (2024)

FDA SaMD GMLP Guidelines (2021)

ISO 14971 â€“ Risk Management in Medical Devices

Good practices in ML for Biomedical Signal Analysis

ğŸ›‘ Avertissement


Ce dÃ©pÃ´t est un projet de simulation bioinformatique Ã  visÃ©e Ã©ducative.
Il ne constitue ni un dispositif mÃ©dical certifiÃ©, ni un outil de diagnostic autonome.
Toute dÃ©cision clinique doit Ãªtre validÃ©e par un professionnel de santÃ©.
